(window.webpackJsonp=window.webpackJsonp||[]).push([[8,3,4],{427:function(t,e,n){var content=n(440);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(94).default)("b5f57896",content,!0,{sourceMap:!1})},428:function(t,e,n){"use strict";n.r(e);var o=n(432),c=n(437),r=n(438);o.Terminal.applyAddon(c),o.Terminal.applyAddon(r),e.default=o.Terminal},439:function(t,e,n){"use strict";n(427)},440:function(t,e,n){var o=n(93)(!1);o.push([t.i,".terminal{width:100%;height:100%;padding-top:10px;padding-bottom:10px}",""]),t.exports=o},452:function(t,e,n){"use strict";n.r(e);n(92);var o=n(428),c={name:"Console",props:{terminal:{type:Object,default:{}}},data:function(){return{term:null,socket:null,connecting:!1}},methods:{runRealTerminal:function(){this.term.writeln("Connected")},errorRealTerminal:function(){this.term.writeln("Websocket Error")},closeRealTerminal:function(){this.term.writeln("Websocket Closed"),this.connecting=!1},connect:function(t){if(console.log("pid : "+this.terminal.pid+" is on ready"),!this.connecting){if(!this.term){var e=document.getElementById("terminal");this.term=new o.default,this.term.open(e)}this.term.writeln("Connecting host(".concat(t,") ...")),this.socket=new WebSocket("ws://".concat(location.host,"/ssh/term?path=").concat(t)),this.socket.onopen=this.runRealTerminal,this.socket.onclose=this.closeRealTerminal,this.socket.onerror=this.errorRealTerminal,this.term.attach(this.socket),this.term._initialized=!0,console.log("mounted is going on"),this.connecting=!0}}},mounted:function(){},beforeDestroy:function(){this.socket&&this.socket.close(),this.term&&this.term.destroy()}},r=(n(439),n(54)),component=Object(r.a)(c,(function(){return(0,this._self._c)("div",{staticClass:"console",attrs:{id:"terminal"}})}),[],!1,null,null,null);e.default=component.exports},491:function(t,e,n){"use strict";n.r(e);n(29);var o=n(88),c=n.n(o),r={name:"WebSSH",data:function(){return{host:{name:"",path:""},terminal:{pid:1,name:"terminal",cols:400,rows:400},lastcmd:"",cmdin:"",ldrawer:!1,rdrawer:!1,timeout:null,hostTableData:[]}},methods:{onSearch:function(){var t=this,e=this.cmdin;e.length>10||e.length<2||/^@/.test(e)&&(e=e.substring(1),c.a.get("/api/cmd/search",{params:{path:"%".concat(e,"%"),offset:0,limit:10}}).then((function(e){if(200!=e.status||0!=e.data.code)throw"Error: Query Data";t.hostTableData=e.data.data,t.hostCount=e.data.count})).catch(console.log))},onKeyEvent:function(t){if(t.altKey||t.ctrlKey)switch(t.key){case"Enter":if(""==this.cmdin)return;this.lastcmd=this.cmdin,this.cmdin+="\n",this.$refs.console.socket.send(this.cmdin),this.cmdin="";break;case"Backspace":""!=this.cmdin&&(this.lastcmd=this.cmdin),this.cmdin="";break;case"ArrowUp":""!=this.cmdin&&(this.lastcmd=this.cmdin),this.cmdin="",this.$refs.console.socket.send("[A");break;case"ArrowDown":""!=this.cmdin&&(this.lastcmd=this.cmdin),this.cmdin="",this.$refs.console.socket.send("[B");break;case"z":""==this.cmdin&&(this.cmdin=this.lastcmd)}},onSelectCmd:function(t,e,n){this.cmdin=t.cmd,this.hostTableData=[],this.$refs.searchCmd.focus()},newWindow:function(t){switch(t){case"host":window.open("/?path=".concat(this.host.path),"_blank");break;case"cmd":window.open("/cmd","_blank");break;case"log":window.open("/hostlog?path=".concat(this.host.path),"_blank")}},onConnect:function(){this.$route.query&&this.$route.query.path?(this.host.path=this.$route.query.path,this.$refs.console.connect(this.host.path)):this.$refs.console.connect("unknown")}},mounted:function(){this.onConnect()}},l=n(54),component=Object(l.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("el-menu",{attrs:{mode:"horizontal"}},[e("el-menu-item",{attrs:{index:"2"}},[e("a",{attrs:{href:"/",target:"_blank"}},[t._v("Hosts")])]),t._v(" "),e("el-menu-item",{attrs:{index:"3"}},[e("a",{attrs:{href:"/cmd",target:"_blank"}},[t._v("Commands")])])],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:"2"}},[e("el-breadcrumb",{staticStyle:{"padding-top":"6px"},attrs:{separator:"/"}},[e("el-breadcrumb-item",[t._v("ssh")]),t._v(" "),e("el-breadcrumb-item",[t._v("test")])],1)],1),t._v(" "),e("el-col",{attrs:{span:"22"}},[e("el-button-group",{staticStyle:{float:"right"}},[e("el-button",{attrs:{size:"mini"},on:{click:t.onConnect}},[t._v("连接")]),t._v(" "),e("el-button",{attrs:{size:"mini"},nativeOn:{click:function(e){return t.newWindow("host")}}},[t._v("主机管理")]),t._v(" "),e("el-button",{attrs:{size:"mini"},nativeOn:{click:function(e){return t.newWindow("cmd")}}},[t._v("命令管理")]),t._v(" "),e("el-button",{attrs:{size:"mini"},nativeOn:{click:function(e){return t.newWindow("log")}}},[t._v("执行日志")])],1)],1)],1),t._v(" "),e("Console",{ref:"console",attrs:{terminal:t.terminal}}),t._v(" "),e("el-input",{ref:"searchCmd",attrs:{type:"textarea",autosize:"",placeholder:"COMMAND",clearable:""},on:{input:t.onSearch},nativeOn:{keyup:function(e){return t.onKeyEvent.apply(null,arguments)}},model:{value:t.cmdin,callback:function(e){t.cmdin=e},expression:"cmdin"}}),t._v(" "),e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.hostTableData,border:""},on:{"row-click":t.onSelectCmd}},[e("el-table-column",{attrs:{fixed:"",prop:"path",label:"Path"}}),t._v(" "),e("el-table-column",{attrs:{prop:"name",label:"Name"}}),t._v(" "),e("el-table-column",{attrs:{prop:"cmd",label:"Cmd"}}),t._v(" "),e("el-table-column",{attrs:{prop:"rule",label:"Rule","show-overflow-tooltip":""}})],1)],1)],1)}),[],!1,null,"7619559e",null);e.default=component.exports;installComponents(component,{Console:n(452).default})}}]);